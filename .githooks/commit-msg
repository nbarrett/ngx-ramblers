#!/bin/bash

# Commit message hook to prevent AI attribution lines
# This enforces the "NO AI ATTRIBUTION" rule from AGENTS.md

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Define banned patterns
BANNED_PATTERNS=(
  "Co-Authored-By: Claude"
  "ü§ñ Generated with"
  "Generated with Claude"
  "claude-code"
  "Claude Code"
  "Co-Authored-By:.*Claude"
  "Co-Authored-By:.*Anthropic"
  "noreply@anthropic.com"
)

# Check for each banned pattern
for pattern in "${BANNED_PATTERNS[@]}"; do
  if echo "$COMMIT_MSG" | grep -iq "$pattern"; then
    echo ""
    echo "‚ùå COMMIT REJECTED: AI attribution detected in commit message"
    echo ""
    echo "Found pattern: $pattern"
    echo ""
    echo "According to AGENTS.md, commits must NOT include AI attribution."
    echo "Remove any lines like:"
    echo "  - ü§ñ Generated with [Claude Code](https://claude.ai/code)"
    echo "  - Co-Authored-By: Claude <noreply@anthropic.com>"
    echo ""
    echo "Commits should appear as if written by a human developer."
    echo ""
    exit 1
  fi
done

exit 0
